## 上传下载经典架构

与云存储搭配的使用方式主要有两种：

1. **客户端直传**，客户端把文件直接上传到云存储；

![客户端直传](http://upyun-assets.b0.upaiyun.com/docs/storage/client_upload.png)

主要适用于大量文件（TB 级以上）存储、本地不存储文件或新建项目。

2. **用户服务器中转**，客户端文件先上传到用户服务器，再从用户服务器上传到又拍云云存储。

![服务器中转](http://upyun-assets.b0.upaiyun.com/docs/storage/server_proxy.png)

主要适用于小量文件存储、已使用本地存储项目。

## API 选择

**HTTP REST API**

- 支持用户服务器上传模式；
- 借助 SDK 支持客户端直传模式；
- 默认使用流式上传；
- 支持上传断点续传；
- 支持云端实时图片预处理；

主要适用于大量大文件传输、移动端上传。

**HTTP FORM API**

- 通过表单（FORM）支持客户端直传模式；
- 支持用户服务器上传模式；
- 默认使用表单上传；
- 支持云端数据预处理；

主要适用于大量小文件传输。


## 上传方式

云存储的上传方式，都通过 CDN 进行加速，包括就近上传、链路优化、负载均衡、专线传输、免费等优势。

**流式上传**

对不确定文件大小的文件上传，可以使用流式上传。文件以流的形式上传，后面上传流追加写在前面流后，且上传后即可读取。

主要适用于直播流上传、监控数据上传。


**断点续传**

把文件切成固定大小分片，一个分片一个分片上传（可以并发传），当因网络原因或其他情况上传失败后，从失败分片开始接着传，不需要重头开始传。

主要适用于 MB 及以上文件上传，特别是移动端上传，避免了多次失败带来的差上传体验。

**表单上传**

通过 HTML FORM ，把文件直接上传到云存储。

主要适用于网站、APP 等小文件上传。


**普通上传**

通过一次 HTTP 请求交互完成文件上传，且不对文件进行分片。

主要适用于网络环境良好的情况下小文件上传。


## 下载方式

云存储的下载方式，都通过 CDN 进行加速，包括就近访问、链路优化、负载均衡、专线传输等优势。

**融合 CDN 下载访问**

以 URL 的方式访问文件，文件借助 CDN 的独特特性分发给用户，这些特性包括（自动）动静态文件分离、大文件分段缓存、点播视频文件拖拉等，全面解决大小文件、不同类型文件的分发加速需求。

适用于所有文件访问方式。


**普通下载**

以 API 的方式下载文件。



## 数据预处理

**图片预处理**

- 支持上传同步作图，把图片处理并保存，同时丢掉原图。
- 支持上传异步作图，把图片处理成多张图并保存，支持保存原图。

**音视频预处理**

- 支持上传异步音视频处理，文件上传完后，自动开始音视频处理。


## 数据迁移


**FTP**

对支持 FTP 的存储源，可以使用 FTP 把数据下载下来，再上传到又拍云存储。在这个过程，为了保证迁移数据的一致性，需要处理错误日志。部分 FTP 工具，如 MAC 上的 Transmit（[下载](https://panic.com/transmit/)），支持直接从存储源把文件、目录拖动又拍云存储，减少人工操作量。

主要适用于不想开发数据迁移程序、中小规模数据迁移。

FTP/FTPS 怎么使用，[请点这里](/api/developer_tools/#ftpftps)。


**异步拉取**

对能获取到或已知数据 URL 列表的存储源，可以使用异步拉取，通过文件 URL，利用又拍云 CDN 去获取文件，使文件快速、稳定迁移。

主要适用于中大规模数据迁移。

异步拉取怎么使用，[请点这里](/cloud/spider/)。